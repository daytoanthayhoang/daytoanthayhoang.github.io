<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√în t·∫≠p Chinh Ph·ª•c To√°n 6 HK1 - C√¢u 1,2,3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap');
        
        body {
            font-family: 'Nunito', sans-serif;
            background-color: #f0fdf4; /* Light green bg */
        }

        .btn-option {
            transition: all 0.2s ease;
            touch-action: manipulation;
        }
        
        .btn-option:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .btn-option:active:not(:disabled) {
            transform: scale(0.98);
        }

        /* Animation cho ƒë√∫ng/sai */
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .shake {
            animation: shake 0.3s ease-in-out;
        }

        @keyframes pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .pop {
            animation: pop 0.2s ease-out;
        }

        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .streak-fire {
            color: #ef4444;
            animation: burn 0.5s infinite alternate;
        }

        @keyframes burn {
            from { text-shadow: 0 0 2px #fca5a5, 0 -2px 4px #f87171; }
            to { text-shadow: 0 0 4px #fca5a5, 0 -4px 8px #ef4444; }
        }

        .mode-active {
            background-color: #2563eb; /* blue-600 */
            color: white;
            border-color: #2563eb;
        }

        .mode-inactive {
            background-color: white;
            color: #374151;
            border-color: #d1d5db;
        }
        .mode-inactive:hover {
            background-color: #eff6ff;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center p-4">

    <!-- Header -->
    <header class="w-full max-w-2xl text-center mb-6">
        <h1 class="text-2xl md:text-3xl font-bold text-green-700 uppercase drop-shadow-sm">
            √în t·∫≠p Chinh Ph·ª•c To√°n 6 HK1 - C√¢u 1,2,3
        </h1>
        <p class="text-sm text-gray-600 mt-1">Ch·ªß ƒë·ªÅ 1, 2, 3: S·ªë nguy√™n & Th·ª© t·ª±</p>
    </header>

    <!-- Mode Selection -->
    <div class="w-full max-w-2xl grid grid-cols-2 md:grid-cols-4 gap-2 mb-6">
        <button onclick="setMode('all')" id="btn-mode-all" class="mode-active py-2 px-4 rounded-lg font-bold border-2 shadow-sm">
            <i class="fas fa-random mr-1"></i> T·ªïng H·ª£p
        </button>
        <button onclick="setMode(1)" id="btn-mode-1" class="mode-inactive py-2 px-4 rounded-lg font-bold border-2 shadow-sm">
            C√¢u 1: S·ªë nguy√™n √¢m v√† t·∫≠p h·ª£p Z
        </button>
        <button onclick="setMode(2)" id="btn-mode-2" class="mode-inactive py-2 px-4 rounded-lg font-bold border-2 shadow-sm">
            C√¢u 2: S·ªë ƒë·ªëi
        </button>
        <button onclick="setMode(3)" id="btn-mode-3" class="mode-inactive py-2 px-4 rounded-lg font-bold border-2 shadow-sm">
            C√¢u 3: S·∫Øp th·ª© t·ª±
        </button>
    </div>

    <!-- Stats Board -->
    <div class="w-full max-w-2xl bg-white rounded-xl shadow-md p-4 mb-6 grid grid-cols-4 gap-2 text-center select-none" id="stats-container">
        <!-- Rendered by JS -->
    </div>

    <!-- Question Card -->
    <div class="w-full max-w-2xl bg-white rounded-2xl shadow-lg border-b-4 border-green-600 p-6 relative overflow-hidden">
        
        <!-- Question Badge -->
        <div class="absolute top-0 left-0 bg-green-100 text-green-800 px-3 py-1 rounded-br-lg text-xs font-bold uppercase" id="question-type-badge">
            D·∫°ng c√¢u h·ªèi
        </div>

        <!-- Question Content -->
        <div class="mt-4 mb-8 fade-in">
            <h2 class="text-xl md:text-2xl font-bold text-gray-800 text-center leading-relaxed" id="question-text">
                ƒêang t·∫£i c√¢u h·ªèi...
            </h2>
        </div>

        <!-- Options Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="options-container">
            <!-- Buttons will be injected here -->
        </div>

        <!-- Explanation Area (New) -->
        <div id="explanation-area" class="hidden mt-6 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded-r-lg text-gray-700 text-sm md:text-base fade-in">
             <!-- JS will inject content -->
        </div>

        <!-- Feedback & Next -->
        <div class="mt-6 h-12 flex items-center justify-between">
            <div id="feedback-msg" class="text-lg font-bold hidden pl-2"></div>
            <button onclick="handleNextClick()" id="btn-next" class="bg-white border border-gray-300 text-gray-600 px-6 py-2 rounded-full font-bold hover:bg-gray-100 transition flex items-center ml-auto shadow-sm">
                B·ªè qua <i class="fas fa-forward ml-2"></i>
            </button>
        </div>
    </div>

    <footer class="mt-auto py-6 text-center text-gray-400 text-xs">
        ¬© Th·∫ßy Nguy·ªÖn Vi·ªát Ho√†ng - Tr∆∞·ªùng THCS Nguy·ªÖn An Kh∆∞∆°ng - daytoanthayhoang.github.io
    </footer>

    <!-- Feedback Modal (Overlay) -->
    <div id="feedback-overlay" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center p-4 fade-in">
        <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full p-6 text-center relative">
            <div id="feedback-icon" class="text-6xl mb-4"></div>
            <h3 id="feedback-title" class="text-2xl font-bold mb-2"></h3>
            <p id="feedback-message" class="text-gray-700 mb-4 text-lg font-medium"></p>
            <div class="bg-blue-50 p-4 rounded-xl text-left mb-6">
                <p class="text-xs text-blue-500 font-bold uppercase mb-1">Gi·∫£i th√≠ch:</p>
                <p id="feedback-detail" class="text-gray-800 text-sm leading-relaxed"></p>
            </div>
            <button onclick="closeModal()" class="w-full py-3 bg-blue-600 text-white font-bold rounded-xl shadow-lg hover:bg-blue-700 transition transform hover:-translate-y-1">
                ƒê√≥ng ƒë·ªÉ xem l·∫°i <i class="fas fa-times ml-2"></i>
            </button>
        </div>
    </div>

    <script>
        // --- DATA & STATE ---
        const state = {
            mode: 'all', // all, 1, 2, 3
            streak: 0,
            correct: 0,
            wrong: 0,
            skipped: 0,
            currentQuestion: null,
            isAnswered: false
        };

        // --- UTILS ---
        const randomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
        
        const shuffleArray = (array) => {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        };

        const generateUniqueInts = (count, min, max, exclude = []) => {
            let res = new Set(exclude);
            while(res.size < count + exclude.length) {
                res.add(randomInt(min, max));
            }
            let arr = Array.from(res);
            return arr.filter(x => !exclude.includes(x)).slice(0, count);
        };

        // --- QUESTION GENERATORS ---

        // C√ÇU 1: NH·∫¨N BI·∫æT S·ªê NGUY√äN
        const generateQ1 = () => {
            const isStandard = Math.random() < 0.7;
            let question, correct, distractors, explanation;

            if (isStandard) {
                question = "Trong c√°c s·ªë sau ƒë√¢y, s·ªë n√†o l√† <b>s·ªë nguy√™n √¢m</b>?";
                const negatives = [-9, -4, -1, -8, -5, -6, -2, -3, -11, -29];
                correct = negatives[randomInt(0, negatives.length - 1)];
                const positives = [0, 12, 5, 10, 25, 4, 2, 3, 9, 6, 15];
                distractors = shuffleArray(positives).slice(0, 3);
                explanation = `S·ªë nguy√™n √¢m l√† c√°c s·ªë nh·ªè h∆°n 0 v√† c√≥ d·∫•u tr·ª´ (-) ƒë·∫±ng tr∆∞·ªõc. S·ªë <b>${correct}</b> th·ªèa m√£n ƒëi·ªÅu ki·ªán n√†y. C√°c s·ªë 0 v√† s·ªë d∆∞∆°ng kh√¥ng ph·∫£i l√† s·ªë nguy√™n √¢m.`;
            } else {
                const subType = randomInt(1, 2);
                if (subType === 1) {
                    question = "S·ªë n√†o <b>kh√¥ng ph·∫£i</b> l√† s·ªë nguy√™n √¢m, c≈©ng <b>kh√¥ng ph·∫£i</b> l√† s·ªë nguy√™n d∆∞∆°ng?";
                    correct = 0;
                    distractors = generateUniqueInts(3, -10, 10, [0]);
                    explanation = "S·ªë 0 kh√¥ng ph·∫£i l√† s·ªë nguy√™n √¢m v√† c≈©ng kh√¥ng ph·∫£i l√† s·ªë nguy√™n d∆∞∆°ng. N√≥ l√† ranh gi·ªõi gi·ªØa hai t·∫≠p h·ª£p n√†y.";
                } else {
                    question = "Ph·∫ßn t·ª≠ n√†o sau ƒë√¢y <b>kh√¥ng thu·ªôc</b> t·∫≠p h·ª£p s·ªë nguy√™n Z?";
                    const decimals = [1.5, 0.5, -2.4, "1/3", "2/5"];
                    correct = decimals[randomInt(0, decimals.length - 1)];
                    distractors = generateUniqueInts(3, -10, 10);
                    explanation = `T·∫≠p h·ª£p s·ªë nguy√™n Z ch·ªâ g·ªìm c√°c s·ªë nguy√™n √¢m, s·ªë 0 v√† s·ªë nguy√™n d∆∞∆°ng. <b>${correct}</b> l√† s·ªë th·∫≠p ph√¢n (ho·∫∑c ph√¢n s·ªë) n√™n kh√¥ng thu·ªôc Z.`;
                }
            }

            return {
                typeLabel: "C√¢u 1: Nh·∫≠n bi·∫øt",
                text: question,
                correct: correct,
                options: shuffleArray([correct, ...distractors]),
                explanation: explanation
            };
        };

        // C√ÇU 2: S·ªê ƒê·ªêI
        const generateQ2 = () => {
            const isStandard = Math.random() < 0.7;
            let targetNum, correct, question, distractors, explanation;

            if (isStandard) {
                const inputs = [-11, -3, -6, -8, -9, -10, -5, -99, -12];
                targetNum = inputs[randomInt(0, inputs.length - 1)];
                question = `S·ªë ƒë·ªëi c·ªßa s·ªë <b>${targetNum}</b> l√†:`;
                correct = -targetNum;
                
                let d1 = targetNum;
                let d2 = 0;
                let d3 = Math.abs(targetNum) + (Math.random() < 0.5 ? 1 : -1); 
                if (d3 === 0) d3 = 1;
                distractors = [d1, d2, d3];
                explanation = `Hai s·ªë ƒë·ªëi nhau c√≥ t·ªïng b·∫±ng 0. S·ªë ƒë·ªëi c·ªßa m·ªôt s·ªë √¢m l√† s·ªë d∆∞∆°ng t∆∞∆°ng ·ª©ng. V·∫≠y s·ªë ƒë·ªëi c·ªßa ${targetNum} l√† <b>${correct}</b>.`;
            } else {
                if (Math.random() < 0.2) {
                    targetNum = 0;
                    question = "S·ªë ƒë·ªëi c·ªßa s·ªë <b>0</b> l√†:";
                    correct = 0;
                    distractors = [1, -1, 10];
                    explanation = "S·ªë ƒë·ªëi c·ªßa 0 l√† ch√≠nh n√≥ (0).";
                } else {
                    const inputs = [5, 6, 12, 18, 26];
                    targetNum = inputs[randomInt(0, inputs.length - 1)];
                    question = `S·ªë ƒë·ªëi c·ªßa s·ªë <b>${targetNum}</b> l√†:`;
                    correct = -targetNum;
                    distractors = [targetNum, 0, targetNum + 1];
                    explanation = `S·ªë ƒë·ªëi c·ªßa m·ªôt s·ªë d∆∞∆°ng l√† s·ªë √¢m t∆∞∆°ng ·ª©ng. V·∫≠y s·ªë ƒë·ªëi c·ªßa ${targetNum} l√† <b>${correct}</b>.`;
                }
            }

            return {
                typeLabel: "C√¢u 2: S·ªë ƒë·ªëi",
                text: question,
                correct: correct,
                options: shuffleArray([correct, ...distractors]),
                explanation: explanation
            };
        };

        // C√ÇU 3: TH·ª® T·ª∞ S·ªê NGUY√äN
        const generateQ3 = () => {
            const isAscending = Math.random() < 0.7; // 70% TƒÉng d·∫ßn
            
            let count = 4;
            let numbers = [];
            numbers.push(randomInt(-20, -1));
            numbers.push(randomInt(1, 20));
            if (Math.random() < 0.5) numbers.push(0);
            else numbers.push(randomInt(-20, 20));
            
            while(numbers.length < count) {
                let n = randomInt(-30, 30);
                if (!numbers.includes(n)) numbers.push(n);
            }

            let sortedArr = [...numbers].sort((a, b) => a - b);
            if (!isAscending) sortedArr.reverse();

            const orderText = isAscending ? "tƒÉng d·∫ßn" : "gi·∫£m d·∫ßn";
            const question = `S·∫Øp x·∫øp c√°c s·ªë nguy√™n sau theo th·ª© t·ª± <b>${orderText}</b>: <br/> <span class="text-blue-600 font-mono text-lg">[ ${numbers.join("; ")} ]</span>`;
            
            const correctStr = sortedArr.join("; ");

            let wrong1 = [...sortedArr].reverse().join("; ");
            let wrong2 = shuffleArray([...numbers]).join("; ");
            while(wrong2 === correctStr) wrong2 = shuffleArray([...numbers]).join("; ");

            let w3Arr = [...sortedArr];
            if (w3Arr.length >= 2) {
                let temp = w3Arr[1];
                w3Arr[1] = w3Arr[2];
                w3Arr[2] = temp;
            }
            let wrong3 = w3Arr.join("; ");

            let optionsSet = new Set([correctStr, wrong1, wrong2, wrong3]);
            while (optionsSet.size < 4) {
                optionsSet.add(shuffleArray([...numbers]).join("; "));
            }

            const explanation = `Th·ª© t·ª± ƒë√∫ng tr√™n tr·ª•c s·ªë l√†: S·ªë √¢m nh·ªè h∆°n 0, 0 nh·ªè h∆°n s·ªë d∆∞∆°ng. V·ªõi s·ªë √¢m, s·ªë n√†o c√≥ ph·∫ßn t·ª± nhi√™n l·ªõn h∆°n th√¨ nh·ªè h∆°n.<br>Th·ª© t·ª± ${orderText} ƒë√∫ng l√†: <b>${correctStr}</b>`;

            return {
                typeLabel: "C√¢u 3: Th·ª© t·ª±",
                text: question,
                correct: correctStr,
                options: shuffleArray(Array.from(optionsSet)),
                explanation: explanation
            };
        };

        // --- CORE FUNCTIONS ---

        const renderStats = () => {
            const container = document.getElementById('stats-container');
            container.innerHTML = `
                <div class="flex flex-col items-center">
                    <span class="text-xs text-gray-500 uppercase font-bold">Chu·ªói th·∫Øng üî•</span>
                    <span class="text-3xl font-extrabold ${state.streak > 2 ? 'streak-fire' : 'text-gray-800'}">
                        ${state.streak > 2 ? '<i class="fas fa-fire"></i> ' : ''}${state.streak}
                    </span>
                </div>
                <div class="flex flex-col items-center border-l">
                    <span class="text-xs text-gray-500 uppercase font-bold">ƒê√∫ng</span>
                    <span class="text-xl font-bold text-green-600">${state.correct}</span>
                </div>
                <div class="flex flex-col items-center border-l">
                    <span class="text-xs text-gray-500 uppercase font-bold">Sai</span>
                    <span class="text-xl font-bold text-red-500">${state.wrong}</span>
                </div>
                <div class="flex flex-col items-center border-l">
                    <span class="text-xs text-gray-500 uppercase font-bold">B·ªè qua</span>
                    <span class="text-xl font-bold text-gray-400">${state.skipped}</span>
                </div>
            `;
        };

        const setMode = (mode) => {
            state.mode = mode;
            ['all', 1, 2, 3].forEach(m => {
                const btn = document.getElementById(`btn-mode-${m}`);
                if (m == mode) {
                    btn.className = "mode-active py-2 px-4 rounded-lg font-bold border-2 shadow-sm transform scale-105 transition";
                } else {
                    btn.className = "mode-inactive py-2 px-4 rounded-lg font-bold border-2 shadow-sm transition";
                }
            });
            handleNextClick(true);
        };

        const loadQuestion = () => {
            state.isAnswered = false;
            let qData;
            
            let selectedMode = state.mode;
            if (state.mode === 'all') {
                selectedMode = randomInt(1, 3);
            }

            if (selectedMode == 1) qData = generateQ1();
            else if (selectedMode == 2) qData = generateQ2();
            else qData = generateQ3();

            state.currentQuestion = qData;

            // Render UI
            document.getElementById('question-type-badge').innerText = qData.typeLabel;
            document.getElementById('question-text').innerHTML = qData.text;
            
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            qData.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = "btn-option w-full bg-blue-50 hover:bg-blue-100 text-blue-900 border border-blue-200 p-4 rounded-xl text-lg font-semibold shadow-sm text-left flex items-center group";
                const labels = ['A', 'B', 'C', 'D'];
                btn.innerHTML = `<span class="inline-block w-8 h-8 rounded-full bg-blue-200 text-center leading-8 mr-3 text-blue-800 font-bold shadow-sm group-hover:bg-blue-600 group-hover:text-white transition">${labels[index]}</span> ${opt}`;
                
                btn.onclick = () => checkAnswer(opt, btn);
                optionsContainer.appendChild(btn);
            });

            // Reset footer & Feedback
            document.getElementById('feedback-msg').className = "hidden";
            document.getElementById('explanation-area').className = "hidden mt-6 p-4 bg-yellow-50 border-l-4 border-yellow-400 rounded-r-lg text-gray-700 text-sm md:text-base fade-in";
            document.getElementById('explanation-area').innerHTML = '';
            
            const btnNext = document.getElementById('btn-next');
            btnNext.innerHTML = 'B·ªè qua <i class="fas fa-forward ml-2"></i>';
            btnNext.className = "bg-white border border-gray-300 text-gray-600 px-6 py-2 rounded-full font-bold hover:bg-gray-100 transition flex items-center ml-auto shadow-sm";
        };

        const checkAnswer = (selectedVal, btnElement) => {
            if (state.isAnswered) return;
            state.isAnswered = true;

            const isCorrect = selectedVal == state.currentQuestion.correct;
            const feedbackEl = document.getElementById('feedback-msg');
            const explArea = document.getElementById('explanation-area');
            const overlay = document.getElementById('feedback-overlay');
            const icon = document.getElementById('feedback-icon');
            const title = document.getElementById('feedback-title');
            const msg = document.getElementById('feedback-message');
            const detail = document.getElementById('feedback-detail');

            // Disable all buttons
            const allBtns = document.querySelectorAll('.btn-option');
            allBtns.forEach(b => {
                b.disabled = true;
                b.classList.add('opacity-70');
            });

            // --- T√åM V√Ä T√î ƒê·∫¨M ƒê√ÅP √ÅN ƒê√öNG ---
            let correctBtn = null;
            allBtns.forEach(b => {
                if(b.innerText.includes(state.currentQuestion.correct.toString())) {
                     // Ki·ªÉm tra k·ªπ h∆°n ƒë·ªÉ tr√°nh tr∆∞·ªùng h·ª£p s·ªë 1 n·∫±m trong 10
                     // Logic t·∫°m th·ªùi: so s√°nh text. V·ªõi tr·∫Øc nghi·ªám to√°n text options kh√° unique.
                     // Tuy nhi√™n ƒë·ªÉ ch√≠nh x√°c tuy·ªát ƒë·ªëi, ta c√≥ th·ªÉ ƒë√°nh d·∫•u index l√∫c render.
                     // ·ªû ƒë√¢y ta d√πng logic text includes ƒë∆°n gi·∫£n v√¨ options generator ƒë·∫£m b·∫£o ƒë·ªôc nh·∫•t.
                     
                     // C·∫£i thi·ªán logic t√¨m: L·∫•y text content sau label "A ", "B "
                     const textContent = b.textContent.trim().substring(2); // B·ªè A, B...
                     if (textContent == state.currentQuestion.correct.toString()) {
                         correctBtn = b;
                     }
                }
            });
            // Fallback n·∫øu kh√¥ng t√¨m th·∫•y ch√≠nh x√°c (do kho·∫£ng tr·∫Øng hay format)
            if(!correctBtn) {
                 allBtns.forEach(b => { 
                     if(b.innerText.includes(state.currentQuestion.correct)) correctBtn = b; 
                 });
            }

            if (correctBtn) {
                correctBtn.classList.remove('bg-blue-50', 'text-blue-900', 'border-blue-200', 'opacity-70');
                correctBtn.classList.add('bg-green-100', 'text-green-800', 'border-green-600', 'border-2', 'opacity-100');
                const span = correctBtn.querySelector('span');
                if(span) {
                    span.classList.remove('bg-blue-200', 'text-blue-800');
                    span.classList.add('bg-green-600', 'text-white');
                }
            }

            if (isCorrect) {
                // UI Correct (User chose correct)
                btnElement.classList.add('bg-green-500', 'text-white', 'pop'); // Th√™m hi·ªáu ·ª©ng pop cho n√∫t ch·ªçn
                btnElement.classList.remove('bg-green-100', 'text-green-800'); // Override style default correct
                const span = btnElement.querySelector('span');
                if(span) {
                    span.classList.remove('bg-green-600', 'text-white');
                    span.classList.add('bg-white', 'text-green-600');
                }

                feedbackEl.innerHTML = `<span class="text-green-600"><i class="fas fa-check-circle"></i> Ch√≠nh x√°c!</span>`;
                feedbackEl.className = "text-lg font-bold block pl-2 animate-bounce";
                
                state.streak++;
                state.correct++;
            } else {
                // UI Wrong (User chose wrong)
                btnElement.classList.remove('bg-blue-50', 'text-blue-900', 'border-blue-200');
                btnElement.classList.add('bg-red-500', 'text-white', 'border-red-600', 'shake', 'opacity-100');
                const span = btnElement.querySelector('span');
                if(span) {
                     span.classList.remove('bg-blue-200', 'text-blue-800');
                     span.classList.add('bg-white', 'text-red-600');
                }
                
                feedbackEl.innerHTML = `<span class="text-red-500"><i class="fas fa-times-circle"></i> Ch∆∞a ƒë√∫ng!</span>`;
                feedbackEl.className = "text-lg font-bold block pl-2";

                state.streak = 0;
                state.wrong++;

                // Setup Modal
                icon.innerHTML = '<i class="fas fa-times-circle text-red-500"></i>';
                title.innerText = "Ch∆∞a ch√≠nh x√°c";
                title.className = "text-2xl font-bold mb-2 text-red-600";
                msg.innerText = `ƒê√°p √°n ƒë√∫ng l√†: ${state.currentQuestion.correct}`;
                
                // Show modal after delay
                setTimeout(() => { overlay.classList.remove('hidden'); }, 400);
            }

            renderStats();

            // Hi·ªÉn th·ªã gi·∫£i th√≠ch inline
            explArea.innerHTML = `<p class="font-bold text-blue-800 mb-1"><i class="fas fa-lightbulb text-yellow-500 mr-2"></i>Gi·∫£i th√≠ch chi ti·∫øt:</p> ${state.currentQuestion.explanation}`;
            explArea.classList.remove('hidden');

            // Setup Modal Detail (lu√¥n set n·ªôi dung ƒë·ªÉ khi m·ªü modal l√† c√≥)
            detail.innerHTML = state.currentQuestion.explanation;

            // Update Next Button
            const btnNext = document.getElementById('btn-next');
            btnNext.innerHTML = `Ti·∫øp theo <i class="fas fa-arrow-right ml-2"></i>`;
            btnNext.className = "bg-green-600 text-white px-6 py-2 rounded-full font-bold hover:bg-green-700 transition flex items-center ml-auto shadow-lg transform scale-105";
        };

        const handleNextClick = (forceSkip = false) => {
            if (!state.isAnswered && !forceSkip) {
                // Logic B·ªè qua
                state.streak = 0;
                state.skipped++;
                renderStats();
            }
            loadQuestion();
        };

        const closeModal = () => {
            document.getElementById('feedback-overlay').classList.add('hidden');
        };

        // Init
        window.onload = () => {
            renderStats();
            loadQuestion();
        }

    </script>
</body>
</html>